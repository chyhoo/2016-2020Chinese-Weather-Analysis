# 2016-2020Chinese-Weather-Analysis

一、爬取数据
1.确定爬虫要获取的数据：2016-2020年全国363个城市每天的天气情况(城市名、日期、天气状况、气温、风力风向)
2.爬取的网站：天气后报网(http://www.tianqihoubao.com/lishi)
3.要使用的技术：lxml、BeautifulSoup、requests、(多线程queue)
4.分析待抓取数据的网站：
  1)打开天气后报网(http://www.tianqihoubao.com/lishi)，
  
5.爬虫程序: 
  1)爬取数据.py 普通的爬虫程序(以城市位单位,最终获得363张csv表) 虽然设置了随机请求头和延时,但是由于需要发送21780次url请求,还是很容易造成([WinError 10054] 远程主机强迫关闭了一个现有的连接)错误,导致程序退出,因此提供了改进的版本(多线程爬虫)

  2)爬取数据多线程.py 多线程爬虫程序(以月份为单位,最终获得21780张csv表)
    优点: 虽然无法避免[WinError 10054]错误,但是即使发生了,也只是会退出那一个线程,而不会导致整个程序的退出,而且在效率上是上面的六倍左右
    缺点: 发生错误的线程将无法获取该线程内url的数据,造成数据缺失,因此提供了(查找缺失数据并重构url.py),查找出有缺失数据的城市,并且重构城市url,可以将print(lack_data_url)出的列表返回(爬取数据多线程.py),最终获得完整的数据。
    
二、数据整合
  1)数据整合(城市).py 将以月份为单位的21780张csv表整合成以城市为单位的363张csv表
  2)数据整合(大汇总).py 将以城市为单位的363张csv表汇总到1张csv表中(已提供)

